From 7ed20ae0906f914e08640bd25b1a73b60711d857 Mon Sep 17 00:00:00 2001
From: nift4 <nift4@protonmail.com>
Date: Thu, 11 May 2023 22:30:37 +0200
Subject: [PATCH 3/7] FMRadio: Play Music is dead - fix saved recordings

Change-Id: Icd431b60d4312b977e86f742ba7887c1239c97f1
---
 res/layout/save_dialog.xml                  | 13 +-----------
 src/com/android/fmradio/FmMainActivity.java | 23 +++++++--------------
 2 files changed, 8 insertions(+), 28 deletions(-)

diff --git a/res/layout/save_dialog.xml b/res/layout/save_dialog.xml
index 7782bc4..f1f81a9 100644
--- a/res/layout/save_dialog.xml
+++ b/res/layout/save_dialog.xml
@@ -51,17 +51,6 @@
             android:singleLine="true"
             android:textColor="#000000"
             android:textSize="16sp"/>
-
-        <TextView
-            android:id="@+id/save_dialog_caption"
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content"
-            android:alpha="0.54"
-            android:fontFamily="sans-serif"
-            android:paddingTop="20dip"
-            android:text="@string/save_dialog_caption"
-            android:textColor="#000000"
-            android:textSize="16sp" />
     </LinearLayout>
 
     <LinearLayout
@@ -97,4 +86,4 @@
             android:textSize="14sp" />
     </LinearLayout>
 
-</LinearLayout>
\ No newline at end of file
+</LinearLayout>
diff --git a/src/com/android/fmradio/FmMainActivity.java b/src/com/android/fmradio/FmMainActivity.java
index 39b8a8b..f735283 100644
--- a/src/com/android/fmradio/FmMainActivity.java
+++ b/src/com/android/fmradio/FmMainActivity.java
@@ -823,15 +823,14 @@ public class FmMainActivity extends Activity implements FmFavoriteEditDialog.Edi
                 extras.putInt("playlist", playlistId);
                 try {
                     playMusicIntent.putExtras(extras);
-                    playMusicIntent.setClassName("com.google.android.music",
-                            "com.google.android.music.ui.TrackContainerActivity");
                     playMusicIntent.setType("vnd.android.cursor.dir/playlist");
                     startActivity(playMusicIntent);
                 } catch (IllegalArgumentException | ActivityNotFoundException e1) {
                     try {
                         playMusicIntent = new Intent(Intent.ACTION_VIEW);
-                        playMusicIntent.putExtras(extras);
-                        playMusicIntent.setType("vnd.android.cursor.dir/playlist");
+                        playMusicIntent.setDataAndType(Uri.parse("content://" +
+                                "com.android.externalstorage.documents/document/" +
+                                "primary%3AFM%20Recording"), "vnd.android.document/directory");
                         startActivity(playMusicIntent);
                     } catch (ActivityNotFoundException e2) {
                         // No activity respond
@@ -883,20 +882,12 @@ public class FmMainActivity extends Activity implements FmFavoriteEditDialog.Edi
                         public void onActionTriggered() {
                             Intent playMusicIntent = new Intent(Intent.ACTION_VIEW);
                             try {
-                                playMusicIntent.setClassName("com.google.android.music",
-                                        "com.google.android.music.AudioPreview");
                                 playMusicIntent.setDataAndType(playUri, "audio/3gpp");
                                 startActivity(playMusicIntent);
-                            } catch (IllegalArgumentException | ActivityNotFoundException e1) {
-                                try {
-                                    playMusicIntent = new Intent(Intent.ACTION_VIEW);
-                                    playMusicIntent.setDataAndType(playUri, "audio/3gpp");
-                                    startActivity(playMusicIntent);
-                                } catch (ActivityNotFoundException e2) {
-                                    // No activity respond
-                                    Log.d(TAG,"onActivityResult, no activity "
-                                            + "respond play record file intent");
-                                }
+                            } catch (ActivityNotFoundException e2) {
+                                // No activity respond
+                                Log.d(TAG,"onActivityResult, no activity "
+                                        + "respond play record file intent");
                             }
                         }
                     };
-- 
2.40.1

