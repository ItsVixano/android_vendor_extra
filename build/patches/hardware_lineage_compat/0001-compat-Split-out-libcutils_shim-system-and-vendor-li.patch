From c864ca33bfa0325ac25dd4f9ef5f8eb9f3ee49a7 Mon Sep 17 00:00:00 2001
From: Giovanni Ricca <giovanniricca@proton.me>
Date: Sat, 22 Oct 2022 21:10:49 +0000
Subject: [PATCH] compat: Split out libcutils_shim system and vendor libs

Change-Id: I58c74d3f48397fe5ddc8f71b02e604a31c69e05a
---
 Android.bp | 19 ++++++++++++++-----
 1 file changed, 14 insertions(+), 5 deletions(-)

diff --git a/Android.bp b/Android.bp
index 3efe204..e497fc0 100644
--- a/Android.bp
+++ b/Android.bp
@@ -233,15 +233,24 @@ cc_library {
     vendor: true
 }

-cc_library {
-    name: "libcutils_shim",
-    shared_libs: [
-        "libcutils",
-    ],
+cc_defaults {
+    name: "libcutils_shim_defaults",
+    shared_libs: ["libutils"],
     srcs: [
         "libcutils/strdup16to8.cpp",
         "libcutils/strdup8to16.cpp",
     ],
+}
+
+cc_library {
+    name: "libcutils_shim",
+    defaults: ["libcutils_shim_defaults"],
+    system_ext_specific: true,
+}
+
+cc_library {
+    name: "libcutils_shim_vendor",
+    defaults: ["libcutils_shim_defaults"],
     vendor: true,
 }

--
2.34.1
